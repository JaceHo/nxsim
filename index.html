<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Nxsim by kentwait</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">Nxsim</h1>
        <p class="header">nxsim is a Python package for simulating agents in a network</p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/kentwait/nxsim/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/kentwait/nxsim/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/kentwait/nxsim">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/kentwait">kentwait</a></p>


      </header>
      <section>
        <h1>
<a id="nxsim" class="anchor" href="#nxsim" aria-hidden="true"><span class="octicon octicon-link"></span></a><a href="https://github.com/kentwait/nxsim">nxsim</a>
</h1>

<p>Nxsim is a Python package for simulating agents connected by any type of network using
SimPy and Networkx in Python 3.4.</p>

<h2>
<a id="install" class="anchor" href="#install" aria-hidden="true"><span class="octicon octicon-link"></span></a>Install</h2>

<pre><code>pip3 install nxsim  # from PyPI
pip3 install git+git://github.com/kentwait/nxsim.git  # from GitHub
</code></pre>

<h2>
<a id="quickstart" class="anchor" href="#quickstart" aria-hidden="true"><span class="octicon octicon-link"></span></a>Quickstart</h2>

<p>Nxsim provides a framework for doing forward-time simulations of events occurring in a network. It uses Networkx to
create a network and SimPy 3 to create agents over each node in the network.</p>

<p>To create a simulation, nxsim requires a graph generated by Networkx and an "agent" class to populate each node of the
network.</p>

<p>First, create a graph using Networkx.</p>

<pre><code>import networkx as nx

number_of_nodes = 10
G = nx.complete_graph(number_of_nodes)
</code></pre>

<p>Then, subclass <em>BaseNetworkAgent</em> to create your own agent based on your needs.</p>

<pre><code>from nxsim import BaseNetworkAgent

# Just like subclassing a process in SimPy
class MyAgent(BaseNetworkAgent):
    def __init__(self, environment=None, agent_id=0, state=()):  # Make sure to have these three keyword arguments
        super().__init__(environment=environment, agent_id=agent_id, state=state)
        # Add your own attributes here

    def run(self):
        # Add your behaviors here
</code></pre>

<p>Notice that "agents" in nxsim use the same concepts as "processes" in SimPy 3 except that their interactions can be
limited by the graph in the simulation environment. For more information about SimPy, they have a great introduction
posted on their <a href="https://simpy.readthedocs.org/en/latest/simpy_intro/index.html">website</a>.</p>

<p>Here is a graph-based example:</p>

<pre><code>import random
from nxsim import BaseNetworkAgent

class ZombieOutbreak(BaseNetworkAgent):
    def __init__(self, environment=None, agent_id=0, state=()):
        super().__init__(environment=environment, agent_id=agent_id, state=state)
        self.bite_prob = 0.05

    def run(self):
        while True:
            if self.state['id'] == 1:
                self.zombify()
                yield self.env.timeout(1)
            else:
                yield self.env.event()

    def zombify(self):
        normal_neighbors = self.get_neighboring_agents(state_id=0)
        for neighbor in normal_neighbors:
            if random.random() &lt; self.bite_prob:
                neighbor.state['id'] = 1  # zombie
                print(self.env.now, self.id, neighbor.id, sep='\t')
                break
</code></pre>

<p>You can now set-up your simulation by creating a <em>NetworkSimulation</em> instance.</p>

<pre><code>from nxsim import NetworkSimulation

# Initialize agent states. Let's assume everyone is normal.
# Add keys as as necessary, but "id" must always refer to that state category
init_states = [{'id': 0, } for _ in range(number_of_nodes)]

# Seed a zombie
init_states[5] = {'id': 1}
sim = NetworkSimulation(topology=G, states=init_states, agent_type=ZombieOutbreak,
                        max_time=30, dir_path='sim_01', num_trials=1, logging_interval=1.0)
</code></pre>

<p>And finally, start it up.</p>

<pre><code>sim.run_simulation()
</code></pre>

<p>Running the simulation saves pickled dictionaries into the <em>dir_path</em> folder, in this case to "sim_01".
Now, let's retrieve the history and states of the trial</p>

<pre><code>trial = BaseLoggingAgent.open_trial_state_history(dir_path='sim_01', trial_id=0)
</code></pre>

<p>And plot the number of zombies per time interval using matplotlib:</p>

<pre><code>from matplotlib import pyplot as plt
zombie_census = [sum([1 for node_id, state in g.items() if state['id'] == 1]) for t,g in trial.items()]
plt.plot(zombie_census)
</code></pre>

<p>And that's it!</p>

<h2>
<a id="note" class="anchor" href="#note" aria-hidden="true"><span class="octicon octicon-link"></span></a>Note</h2>

<p>This package is still under development. If you encounter a bug, please file an issue at <a href="https://github.com/kentwait/nxsim/issues">https://github.com/kentwait/nxsim/issues</a> to get it resolved.</p>

<h2>
<a id="acknowledgment" class="anchor" href="#acknowledgment" aria-hidden="true"><span class="octicon octicon-link"></span></a>Acknowledgment</h2>

<p>Thanks to Jo√© Schaul for bringing <a href="https://github.com/jschaul/ComplexNetworkSim">ComplexNetworkSim</a> to the world.
This project is a SimPy 3- and Python 3.4-compatible fork of ComplexNetworkSim.</p>

<h2>
<a id="links" class="anchor" href="#links" aria-hidden="true"><span class="octicon octicon-link"></span></a>Links</h2>

<ul>
<li><a href="https://github.com/kentwait/nxsim">nxsim - Github</a></li>
<li><a href="https://pypi.python.org/pypi/nxsim">nxsim - PyPI</a></li>
<li><a href="https://simpy.readthedocs.org/en/latest/contents.html">SimPy v3.0 Documentation</a></li>
<li><a href="http://networkx.github.io/documentation/networkx-1.9.1">Networkx v1.9 Documentation</a></li>
<li><a href="http://matplotlib.org/users/">matplotlib v1.4.3 Documentation</a></li>
<li><a href="https://pythonhosted.org/ComplexNetworkSim">ComplexNetworkSim Documentation</a></li>
</ul>
      </section>
      <footer>
        <p><small>Hosted on <a href="https://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		
  </body>
</html>
